<!-- Section 6: Questions relatives à l'adoption (mise à jour) -->
            <div class="section" data-step="6">
                <div class="section-title">Questions relatives à l'adoption</div>
                <div class="section-content">
                    <div class="form-group">
                        <label>Quand avez-vous pris la décision de placer votre enfant dans une crèche ?</label>
                        <textarea id="decision_adoption" name="decision_adoption" placeholder="Décrivez les circonstances..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Connaissiez-vous cette crèche auparavant ?</label>
                        <textarea id="connaissance_creche" name="connaissance_creche" placeholder="Expliquez votre connaissance de cette institution..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Sinon, qui vous a renseigné sur cette crèche ?</label>
                        <textarea id="renseignement_creche" name="renseignement_creche" placeholder="Indiquez qui vous a informé..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Depuis quand votre enfant est-il placé dans cette crèche / Chez cette personne ?</label>
                        <textarea name="depuis_quand_place" placeholder="Précisez depuis quand..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>À quelle fréquence rendez-vous visite à vos enfants à la crèche / Chez cette personne ?</label>
                        <textarea id="frequence_visite" name="frequence_visite" placeholder="Décrivez la fréquence des visites..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Pourquoi aviez-vous décidé de donner votre enfant en adoption ?</label>
                        <textarea id="raison_adoption" name="raison_adoption" placeholder="Expliquez les raisons..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Dites-nous tout ce que vous avez appris de l'adoption</label>
                        <textarea id="apprentissage_adoption" name="apprentissage_adoption" placeholder="Partagez vos connaissances sur l'adoption..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Voulez-vous avoir d'autres informations sur l'adoption ?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="autres_infos_adoption" value="oui" id="autres_infos_oui">
                                <label for="autres_infos_oui">Oui</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="autres_infos_adoption" value="non" id="autres_infos_non">
                                <label for="autres_infos_non">Non</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Avez-vous parlé de l'adoption de votre enfant aux autres membres de la famille ?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="parle_famille_adoption" value="oui" id="parle_famille_oui">
                                <label for="parle_famille_oui">Oui</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="parle_famille_adoption" value="non" id="parle_famille_non">
                                <label for="parle_famille_non">Non</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Sinon, pourquoi ?</label>
                            <textarea name="pourquoi_pas_parle_famille" placeholder="Expliquez pourquoi..."></textarea>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Si oui, quelles sont les impressions des membres de la famille ?</label>
                        <textarea name="impressions_famille" placeholder="Décrivez les impressions de la famille..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Voulez-vous prendre le temps de réfléchir quelques minutes avant de prendre une décision finale ?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="temps_reflexion" value="oui" id="temps_reflexion_oui">
                                <label for="temps_reflexion_oui">Oui</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="temps_reflexion" value="non" id="temps_reflexion_non">
                                <label for="temps_reflexion_non">Non</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Si oui quelles sont les décisions que vous aviez prises après ces quelques minutes de réflexions ?</label>
                        <textarea name="decisions_apres_reflexion" placeholder="Décrivez vos décisions..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Voulez-vous signer le pré-consentement ?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="signer_pre_consentement" value="oui" id="pre_consentement_oui">
                                <label for="pre_consentement_oui">Oui</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="signer_pre_consentement" value="non" id="pre_consentement_non">
                                <label for="pre_consentement_non">Non</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Si oui, pourquoi ?</label>
                            <textarea name="pourquoi_pre_consentement_oui" placeholder="Expliquez pourquoi vous voulez signer..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Sinon, pourquoi ?</label>
                            <textarea name="pourquoi_pre_consentement_non" placeholder="Expliquez pourquoi vous ne voulez pas signer..."></textarea>
                        </div>
                    </div>

                    <!-- Commentaires et Recommandations -->
                    <div style="margin-top: 30px; padding: 15px; border: 1px solid #ccc; border-radius: 5px;">
                        <h4>COMMENTAIRES / REMARQUES</h4>
                        <div class="form-group">
                            <textarea name="commentaires_remarques" rows="6" placeholder="Commentaires et remarques de l'agent..."></textarea>
                        </div>
                    </div>

                    <div style="margin-top: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 5px;">
                        <h4>RECOMMANDATIONS</h4>
                        <div class="form-group">
                            <textarea name="recommandations" rows="6" placeholder="Recommandations de l'agent IBESR..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 7: Gestion des données (mise à jour du numéro d'étape) -->
            <div class="section" data-step="7">
                <div class="section-title">Gestion des Données</div>
                <div class="section-content">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Statut du formulaire :</label>
                            <select id="formStatus" name="form_status">
                                <option value="brouillon">Brouillon</option>
                                <option value="en_cours">En cours de traitement</option>
                                <option value="complete">Complété</option>
                                <option value="approuve">Approuvé</option>
                                <option value="rejete">Rejeté</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Numéro de dossier :</label>
                            <input type="text" id="dossierNumber" name="dossier_number" placeholder="Numero de dossier">
                        </div>
                        <div class="form-group">
                            <label>Date de création :</label>
                            <input type="datetime-local" id="creationDate" name="creation_date" readonly>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Notes internes :</label>
                            <textarea id="internalNotes" name="internal_notes" placeholder="Notes pour suivi interne..."></textarea>
                        </div>
                    </div>
                </div>
            </div>            <!-- Section 3: Informations sur l'Habitat et l'Environnement -->
            <div class="section" data-step="3">
                <div class="section-title">Informations sur l'Habitat et l'Environnement</div>
                <div class="section-content">
                    <!-- Statut du chef de ménage -->
                    <div class="form-group">
                        <label>Quel est statut du chef de ménage par rapport à la maison ?</label>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Mère :</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="statut_maison_mere_proprietaire" value="oui">
                                        <label>Propriétaire</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="statut_maison_mere_locataire" value="oui">
                                        <label>Locataire</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="statut_maison_mere_heritier" value="oui">
                                        <label>Héritier</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="statut_maison_mere_autres" value="oui">
                                        <label>Autres</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Père :</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="statut_maison_pere_proprietaire" value="oui">
                                        <label>Propriétaire</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="statut_maison_pere_locataire" value="oui">
                                        <label>Locataire</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="statut_maison_pere_heritier" value="oui">
                                        <label>Héritier</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Depuis combien de temps vivez-vous dans cette maison ?</label>
                            <textarea name="duree_maison" placeholder="Précisez la durée..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Nombre de pièce ?</label>
                            <input type="number" name="nombre_pieces" min="0" placeholder="Nombre de pièces">
                        </div>
                    </div>

                    <!-- Constitution de la maison -->
                    <div class="form-group">
                        <label>De quoi est constituée votre maison ?</label>
                        <div class="form-row">
                            <div class="form-group">
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="maison_tole_blocs" value="oui">
                                        <label>Tôle/Blocs</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="maison_beton_blocs" value="oui">
                                        <label>Béton/Blocs</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="maison_tapis_bois" value="oui">
                                        <label>Tapis/Bois</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="maison_tole_bois" value="oui">
                                        <label>Tôle/Bois</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="maison_tole_pierres" value="oui">
                                        <label>Tôle/Pierres</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Autres :</label>
                                    <input type="text" name="maison_autres" placeholder="Autres matériaux">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Toilette -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>Existe-t-il une toilette ?</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="existe_toilette" value="oui" id="toilette_oui">
                                    <label for="toilette_oui">Oui</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="existe_toilette" value="non" id="toilette_non">
                                    <label for="toilette_non">Non</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Sinon où faites-vous vos besoins ?</label>
                            <textarea name="ou_besoins" placeholder="Précisez où..."></textarea>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Si oui, quel type de toilette ?</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" name="type_toilette_latrine_recouverte" value="oui">
                                <label>Latrine recouverte</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="type_toilette_latrine_non_recouverte" value="oui">
                                <label>Latrine non recouverte</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="type_toilette_chasse_manuelle" value="oui">
                                <label>Chasse d'eau manuelle</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="type_toilette_chasse_automatique" value="oui">
                                <label>Chasse d'eau automatique</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Autres :</label>
                            <input type="text" name="type_toilette_autres" placeholder="Autres types">
                        </div>
                    </div>

                    <!-- Accès aux services -->
                    <div class="form-group">
                        <label>Accès aux services de base dans la zone (Santé / Eau / Hygiène / Éclairage / École)</label>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Mère :</label>
                                <textarea name="acces_services_mere" placeholder="Décrivez l'accès aux services..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Père :</label>
                                <textarea name="acces_services_pere" placeholder="Décrivez l'accès aux services..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Structure de santé -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>Structure de santé la plus proche :</label>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" name="structure_sante_hopital" value="oui">
                                    <label>Hôpital</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="structure_sante_centre" value="oui">
                                    <label>Centre de santé</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="structure_sante_clinique" value="oui">
                                    <label>Clinique</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="structure_sante_dispensaire" value="oui">
                                    <label>Dispensaire</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Autres :</label>
                                <input type="text" name="structure_sante_autres" placeholder="Autres structures">
                            </div>
                        </div>
                    </div>

                    <!-- Approvisionnement en eau -->
                    <div class="form-group">
                        <label>Approvisionnement en Eau :</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" name="eau_fontaine_publique" value="oui">
                                <label>Fontaine publique</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eau_pluie" value="oui">
                                <label>Eau de pluie</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eau_source_riviere" value="oui">
                                <label>Source-Rivière</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eau_puits_non_protege" value="oui">
                                <label>Puits non protégé</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eau_puits_pompe" value="oui">
                                <label>Puits avec Pompe</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eau_citerne_prive" value="oui">
                                <label>Citerne privé (Maison)</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Autres :</label>
                            <input type="text" name="eau_autres" placeholder="Autres sources">
                        </div>
                    </div>

                    <!-- Principale source d'éclairage -->
                    <div class="form-group">
                        <label>Principale source d'éclairage :</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" name="eclairage_edh" value="oui">
                                <label>ED'H</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eclairage_initiative_prive" value="oui">
                                <label>Initiative privé</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eclairage_lampe_kerosene" value="oui">
                                <label>Lampe kérosène</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eclairage_lampe" value="oui">
                                <label>Lampe</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eclairage_gasoil" value="oui">
                                <label>Gasoil</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="eclairage_baleine" value="oui">
                                <label>Baleine</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Autres :</label>
                            <input type="text" name="eclairage_autres" placeholder="Autres sources">
                        </div>
                    </div>

                    <!-- Identification d'établissement scolaire -->
                    <div class="form-group">
                        <label>Identification d'établissement scolaire / Professionnel :</label>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Primaire :</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="radio" name="ecole_primaire" value="oui" id="primaire_oui">
                                        <label for="primaire_oui">Oui</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="radio" name="ecole_primaire" value="non" id="primaire_non">
                                        <label for="primaire_non">Non</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="primaire_prive" value="oui">
                                        <label>Privé</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="primaire_public" value="oui">
                                        <label>Public</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Secondaire :</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="radio" name="ecole_secondaire" value="oui" id="secondaire_oui">
                                        <label for="secondaire_oui">Oui</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="radio" name="ecole_secondaire" value="non" id="secondaire_non">
                                        <label for="secondaire_non">Non</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="secondaire_prive" value="oui">
                                        <label>Privé</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="secondaire_public" value="oui">
                                        <label>Public</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Professionnel :</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="radio" name="ecole_professionnel" value="oui" id="professionnel_oui">
                                        <label for="professionnel_oui">Oui</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="radio" name="ecole_professionnel" value="non" id="professionnel_non">
                                        <label for="professionnel_non">Non</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="professionnel_prive" value="oui">
                                        <label>Privé</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="professionnel_public" value="oui">
                                        <label>Public</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Autres :</label>
                            <input type="text" name="ecole_autres" placeholder="Autres établissements">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 4: Loisirs / Distraction / Relation familial -->
            <div class="section" data-step="4">
                <div class="section-title">Loisirs / Distraction / Relation familial</div>
                <div class="section-content">
                    <!-- Activités de loisirs -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>Quelles sont les activités que vous faites pour vous distraire avec vos enfants?</label>
                            <h5>Mère :</h5>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" name="loisirs_mere_eglise" value="oui">
                                    <label>Aller à l'église</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="loisirs_mere_visiter" value="oui">
                                    <label>Visiter des parents/amis dans d'autres localités</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="loisirs_mere_promenade" value="oui">
                                    <label>Promenade</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="loisirs_mere_baignade" value="oui">
                                    <label>Baignade</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Autres :</label>
                                <input type="text" name="loisirs_mere_autres" placeholder="Autres activités">
                            </div>
                        </div>
                        <div class="form-group">
                            <h5>Père :</h5>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" name="loisirs_pere_eglise" value="oui">
                                    <label>Aller à l'église</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="loisirs_pere_visiter" value="oui">
                                    <label>Visiter des parents/amis dans d'autres localités</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="loisirs_pere_promenade" value="oui">
                                    <label>Promenade</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="loisirs_pere_baignade" value="oui">
                                    <label>Baignade</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Autres :</label>
                                <input type="text" name="loisirs_pere_autres" placeholder="Autres activités">
                            </div>
                        </div>
                    </div>

                    <!-- Types de loisirs -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>Quels types de loisirs pouvez-vous offrir aux enfants ?</label>
                            <h5>Mère :</h5>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_mere_tv" value="oui">
                                    <label>TV</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_mere_musique" value="oui">
                                    <label>Musique</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_mere_sorties" value="oui">
                                    <label>Sorties (entre ami(e)s)</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_mere_danse" value="oui">
                                    <label>Danse</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_mere_camp" value="oui">
                                    <label>Camp</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_mere_sport" value="oui">
                                    <label>Sport</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Autres (détails) :</label>
                                <input type="text" name="types_loisirs_mere_details" placeholder="Autres détails">
                            </div>
                        </div>
                        <div class="form-group">
                            <h5>Père :</h5>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_pere_tv" value="oui">
                                    <label>TV</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_pere_musique" value="oui">
                                    <label>Musique</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_pere_sorties" value="oui">
                                    <label>Sorties (entre ami(e)s)</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_pere_danse" value="oui">
                                    <label>Danse</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_pere_camp" value="oui">
                                    <label>Camp</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="types_loisirs_pere_sport" value="oui">
                                    <label>Sport</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Autres (détails) :</label>
                                <input type="text" name="types_loisirs_pere_details" placeholder="Autres détails">
                            </div>
                        </div>
                    </div>

                    <!-- Même père et mère -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>Est-ce que tous les enfants sont de même père et mère?</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="meme_pere_mere" value="oui" id="meme_pere_mere_oui">
                                    <label for="meme_pere_mere_oui">Oui</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="meme_pere_mere" value="non" id="meme_pere_mere_non">
                                    <label for="meme_pere_mere_non">Non</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Sinon, plus de détails:</label>
                                <textarea name="details_pere_mere_differents" placeholder="Précisez les détails..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Relation entre la fratrie -->
                    <div class="form-group">
                        <label>Comment décrivez-vous la relation entre la fratrie ?</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" name="relation_fratrie_respect" value="oui">
                                <label>Respect mutuel</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="relation_fratrie_complicite" value="oui">
                                <label>Complicité</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="relation_fratrie_solidarite" value="oui">
                                <label>Solidarité</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="relation_fratrie_competitivite" value="oui">
                                <label>Compétitivité</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Autre :</label>
                            <input type="text" name="relation_fratrie_autre" placeholder="Autre type de relation">
                        </div>
                    </div>

                    <!-- Temps de jouer -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>Prenez-vous le temps de jouer avec vos enfants</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="temps_jouer" value="oui" id="temps_jouer_oui">
                                    <label for="temps_jouer_oui">Oui</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="temps_jouer" value="non" id="temps_jouer_non">
                                    <label for="temps_jouer_non">Non</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Explications :</label>
                                <textarea name="explications_temps_jouer" placeholder="Expliquez..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Participation aux décisions -->
                    <div class="form-group">
                        <label>Est-ce que les enfants sont autorisés à vous conseiller ou à participer dans certaines prises de décisions familiales?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="enfants_decisions" value="oui" id="enfants_decisions_oui">
                                <label for="enfants_decisions_oui">Oui</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="enfants_decisions" value="non" id="enfants_decisions_non">
                                <label for="enfants_decisions_non">Non</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Sinon, dites brièvement pourquoi :</label>
                            <textarea name="pourquoi_enfants_decisions" placeholder="Expliquez pourquoi..."></textarea>
                        </div>
                    </div>

                    <!-- Formes de punitions -->
                    <div class="form-group">
                        <label>Quelles sont les formes de punitions les plus courantes que vous utilisez à l'endroit de vos enfants ?</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" name="punitions_fouet" value="oui">
                                <label>Fouet</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="punitions_ceinturon" value="oui">
                                <label>Ceinturon</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="punitions_mettre_genou" value="oui">
                                <label>Mettre l'enfant genou</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="punitions_tape" value="oui">
                                <label>Tape</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Autres :</label>
                            <input type="text" name="punitions_autres" placeholder="Autres formes de punitions">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 5: Activité génératrice de revenu / Accès au crédit -->
            <div class="section" data-step="5">
                <div class="section-title">Activité génératrice de revenu / Accès au crédit</div>
                <div class="section-content">
                    <div class="form-group">
                        <label>Avez-vous l'habitude d'entreprendre des activités économiques ?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="activites_economiques" value="oui" id="activites_eco_oui">
                                <label for="activites_eco_oui">Oui</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="activites_economiques" value="non" id="activites_eco_non">
                                <label for="activites_eco_non">Non</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Si oui quel type d'activités? :</label>
                        <textarea name="type_activites_economiques" placeholder="Décrivez les types d'activités..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Avez-vous une activité économique en ce moment?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="activite_actuelle" value="oui" id="activite_actuelle_oui">
                                <label for="activite_actuelle_oui">Oui</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="activite_actuelle" value="non" id="activite_actuelle_non">
                                <label for="activite_actuelle_non">Non</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Si oui quel type d'activité?</label>
                        <textarea name="type_activite_actuelle" placeholder="Décrivez l'activité actuelle..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Qui soutien économiquement la maison en ce moment ?</label>
                        <textarea name="qui_soutien_economiquement" placeholder="Précisez qui soutient la maison..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Aviez-vous effectué un prêt (crédit) ?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="pret_credit" value="oui" id="pret_oui">
                                <label for="pret_oui">Oui</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="pret_credit" value="non" id="pret_non">
                                <label for="pret_non">Non</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Quelles sont vos principales sources de dépenses ? :</label>
                        <textarea name="principales_depenses" placeholder="Listez vos principales sources de dépenses..."></textarea>
                    </div>

                    <!-- Sécurité alimentaire -->
                    <div style="margin-top: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 5px;">
                        <h4>Sécurité alimentaire</h4>
                        <div class="form-group">
                            <label>Au cours des six mois précédents est-il arrivé que vous ayez passé une journée entière sans rien manger ?</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="journee_sans_manger" value="oui" id="sans_manger_oui">
                                    <label for="sans_manger_oui">Oui</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="journee_sans_manger" value="non" id="sans_manger_non">
                                    <label for="sans_manger_non">Non</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Explications :</label>
                                <textarea name="explications_sans_manger" placeholder="Expliquez les circonstances..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Capital social -->
                    <div style="margin-top: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 5px;">
                        <h4>Capital social</h4>
                        <div class="form-group">
                            <label>Faites-vous partie d'un groupement (réseaux sociaux d'entraide) social, religieux ou autre ?</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="groupement_social" value="oui" id="groupement_oui">
                                    <label for="groupement_oui">Oui</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="groupement_social" value="non" id="groupement_non">
                                    <label for="groupement_non">Non</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Si oui lequel de ces groupements ?</label>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" name="type_groupement_religieux" value="oui">
                                    <label>Association religieuse</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="type_groupement_quartier" value="oui">
                                    <label>Comité de quartier</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="type_groupement_politique" value="oui">
                                    <label>Regroupement politique</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="type_groupement_cooperative" value="oui">
                                    <label>Coopérative</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="type_groupement_syndicato" value="oui">
                                    <label>Syndicato</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Autres :</label>
                                <input type="text" name="type_groupement_autres" placeholder="Autres groupements">
                            </div>
                        </div>
                    </div>

                    <!-- Capital physique basique -->
                    <div style="margin-top: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 5px;">
                        <h4>Capital physique basique</h4>
                        <div class="form-group">
                            <label>Quels sont les capitaux physiques dont vous disposez: <strong>Valeur en gourdes</strong></label>
                            <p style="font-style: italic; color: #666;">Outils, marchandise, ou matière première :</p>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Mère :</label>
                                    <div style="margin-bottom: 10px;">
                                        <label>Terre :</label>
                                        <input type="number" name="capital_mere_terre" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Maison :</label>
                                        <input type="number" name="capital_mere_maison" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Moyens de locomotion :</label>
                                        <input type="number" name="capital_mere_locomotion" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Télévision :</label>
                                        <input type="number" name="capital_mere_television" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Radio :</label>
                                        <input type="number" name="capital_mere_radio" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Autres :</label>
                                        <input type="text" name="capital_mere_autres_desc" placeholder="Description">
                                        <input type="number" name="capital_mere_autres_valeur" placeholder="Valeur en gourdes">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Père :</label>
                                    <div style="margin-bottom: 10px;">
                                        <label>Terre :</label>
                                        <input type="number" name="capital_pere_terre" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Maison :</label>
                                        <input type="number" name="capital_pere_maison" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Moyens de locomotion :</label>
                                        <input type="number" name="capital_pere_locomotion" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Télévision :</label>
                                        <input type="number" name="capital_pere_television" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Radio :</label>
                                        <input type="number" name="capital_pere_radio" placeholder="Valeur en gourdes">
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <label>Autres :</label>
                                        <input type="text" name="capital_pere_autres_desc" placeholder="Description">
                                        <input type="number" name="capital_pere_autres_valeur" placeholder="Valeur en gourdes">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 6: Questions relatives à l'adoption (mise à jour) --><!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire d'Évaluation Sociale et Économique - IBESR</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.4;
            color: #333;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 210mm;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            padding: 20px;
            border-bottom: 2px solid #333;
        }

        .logo {
            width: 60px;
            height: 60px;
            border: 2px solid #333;
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .form-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .form-description {
            font-size: 12px;
            margin-bottom: 20px;
            text-align: justify;
        }

        .section {
            margin: 20px;
            border: 1px solid #333;
        }

        .section-title {
            background-color: #f0f0f0;
            padding: 8px 12px;
            font-weight: bold;
            border-bottom: 1px solid #333;
            font-size: 14px;
        }

        .section-content {
            padding: 15px;
        }

        .form-row {
            display: flex;
            margin-bottom: 15px;
            align-items: center;
        }

        .form-group {
            flex: 1;
            margin-right: 15px;
        }

        .form-group:last-child {
            margin-right: 0;
        }

        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 12px;
        }

        input[type="text"], input[type="date"], input[type="number"], input[type="tel"], input[type="datetime-local"], select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 12px;
        }

        textarea {
            height: 60px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            border: 1px solid #333;
            padding: 8px;
            text-align: left;
            font-size: 11px;
        }

        th {
            background-color: #f0f0f0;
            font-weight: bold;
        }

        .btn-container {
            text-align: center;
            padding: 20px;
        }

        .btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin: 0 10px;
        }

        .btn:hover {
            background-color: #0056b3;
        }

        .btn-secondary {
            background-color: #6c757d;
        }

        .btn-secondary:hover {
            background-color: #545b62;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e9ecef;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background-color: #28a745;
            transition: width 0.3s ease;
        }

        /* Styles pour les signatures électroniques */
        .signature-section {
            margin: 20px;
            border: 1px solid #333;
        }

        .signature-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
        }

        .signature-box {
            flex: 1;
            min-width: 300px;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 15px;
            text-align: center;
        }

        .signature-canvas {
            border: 2px dashed #ccc;
            border-radius: 5px;
            cursor: crosshair;
            width: 100%;
            height: 150px;
            background-color: #fafafa;
        }

        .signature-canvas.active {
            border-color: #007bff;
            background-color: white;
        }

        .signature-controls {
            margin-top: 10px;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .signature-btn {
            padding: 5px 10px;
            border: 1px solid #ccc;
            background: white;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .signature-btn:hover {
            background-color: #f8f9fa;
        }

        .signature-info {
            margin-top: 10px;
            font-size: 11px;
            color: #666;
        }

        .signature-date {
            font-weight: bold;
            color: #333;
        }

        .signature-status {
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
        }

        .signature-status.signed {
            background-color: #d4edda;
            color: #155724;
        }

        .signature-status.pending {
            background-color: #fff3cd;
            color: #856404;
        }

        @media print {
            .btn-container, .progress-bar {
                display: none;
            }
            .container {
                box-shadow: none;
            }
            body {
                background: white;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            .form-group {
                margin-right: 0;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- En-tête -->
        <div class="header">
            <div class="logo">IBESR</div>
            <h1 class="form-title">Formulaire d'Évaluation Sociale et Économique</h1>
            <p class="form-description">
                Ce formulaire est utilisé dans le cadre de l'évaluation des familles vulnérables dans le but de 
                déceler leur capacité / incapacité économique et leur volonté de donner leurs enfants en adoption.
            </p>
        </div>

        <!-- Barre de progression -->
        <div class="progress-bar">
            <div class="progress" id="progressBar" style="width: 0%"></div>
        </div>

        <form id="evaluationForm">
            <!-- Section 1: Identification de l'enfant -->
            <div class="section" data-step="1">
                <div class="section-title">Identification de l'enfant / des enfants</div>
                <div class="section-content">
                    <div id="enfants-container">
                        <!-- Premier enfant (toujours présent) -->
                        <div class="enfant-form" data-enfant="1">
                            <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 15px; padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
                                <h4 style="margin: 0; color: #333;">Enfant #1</h4>
                                <button type="button" class="btn btn-secondary" onclick="supprimerEnfant(1)" style="display: none; padding: 5px 10px; font-size: 12px;">Supprimer</button>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="nom_enfant_1">Nom :</label>
                                    <input type="text" id="nom_enfant_1" name="nom_enfant_1" required>
                                </div>
                                <div class="form-group">
                                    <label for="prenom_enfant_1">Prénom :</label>
                                    <input type="text" id="prenom_enfant_1" name="prenom_enfant_1" required>
                                </div>
                                <div class="form-group">
                                    <label for="age_enfant_1">Âge :</label>
                                    <input type="number" id="age_enfant_1" name="age_enfant_1" min="0" max="18">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="sexe_enfant_1">Sexe :</label>
                                    <select id="sexe_enfant_1" name="sexe_enfant_1">
                                        <option value="">Sélectionner</option>
                                        <option value="M">Masculin</option>
                                        <option value="F">Féminin</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="date_naissance_enfant_1">Date de naissance :</label>
                                    <input type="date" id="date_naissance_enfant_1" name="date_naissance_enfant_1">
                                </div>
                                <div class="form-group">
                                    <label for="lieu_naissance_enfant_1">Lieu de naissance :</label>
                                    <input type="text" id="lieu_naissance_enfant_1" name="lieu_naissance_enfant_1" placeholder="Lieu de naissance">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="situation_sociale_1">Situation sociale actuelle de cet enfant :</label>
                                <textarea id="situation_sociale_1" name="situation_sociale_1" placeholder="Décrivez la situation sociale actuelle de cet enfant..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Bouton pour ajouter un autre enfant -->
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="button" class="btn" onclick="ajouterEnfant()" style="background-color: #28a745;">
                            + Ajouter un autre enfant
                        </button>
                        <p style="font-size: 12px; color: #666; margin-top: 5px;">
                            <em>Cliquez pour ajouter des informations sur d'autres enfants concernés par cette évaluation</em>
                        </p>
                    </div>

                    <!-- Résumé des enfants -->
                    <div id="resume-enfants" style="margin-top: 20px; padding: 15px; background-color: #e9ecef; border-radius: 5px; display: none;">
                        <h5 style="margin-bottom: 10px;">Résumé des enfants ajoutés :</h5>
                        <div id="liste-enfants"></div>
                    </div>
                </div>
            </div>

            <!-- Section 2: Identification des parents responsables -->
            <div class="section" data-step="2">
                <div class="section-title">Identification de la (des) personne(s) responsable(s) de l'enfant</div>
                <div class="section-content">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Lien avec l'enfant</th>
                                    <th>Père Biol.</th>
                                    <th>Mère Biol.</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Nom</strong></td>
                                    <td><input type="text" name="nom_pere" placeholder="Nom du père"></td>
                                    <td><input type="text" name="nom_mere" placeholder="Nom de la mère"></td>
                                </tr>
                                <tr>
                                    <td><strong>Prénom</strong></td>
                                    <td><input type="text" name="prenom_pere" placeholder="Prénom du père"></td>
                                    <td><input type="text" name="prenom_mere" placeholder="Prénom de la mère"></td>
                                </tr>
                                <tr>
                                    <td><strong>Date de naissance</strong></td>
                                    <td><input type="date" name="date_naissance_pere"></td>
                                    <td><input type="date" name="date_naissance_mere"></td>
                                </tr>
                                <tr>
                                    <td><strong>Lieu de naissance</strong></td>
                                    <td><input type="text" name="lieu_naissance_pere"></td>
                                    <td><input type="text" name="lieu_naissance_mere"></td>
                                </tr>
                                <tr>
                                    <td><strong>Âge</strong></td>
                                    <td><input type="number" name="age_pere" min="0"></td>
                                    <td><input type="number" name="age_mere" min="0"></td>
                                </tr>
                                <tr>
                                    <td><strong>Téléphone</strong></td>
                                    <td><input type="tel" name="telephone_pere"></td>
                                    <td><input type="tel" name="telephone_mere"></td>
                                </tr>
                                <tr>
                                    <td><strong>Profession</strong></td>
                                    <td><input type="text" name="profession_pere"></td>
                                    <td><input type="text" name="profession_mere"></td>
                                </tr>
                                <tr>
                                    <td><strong>Sexe</strong></td>
                                    <td>
                                        <select name="sexe_pere">
                                            <option value="">Sélectionner</option>
                                            <option value="M">M</option>
                                            <option value="F">F</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select name="sexe_mere">
                                            <option value="">Sélectionner</option>
                                            <option value="M">M</option>
                                            <option value="F">F</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Origine (Dpmt/Comm.)</strong></td>
                                    <td><input type="text" name="origine_pere" placeholder="Département/Commune"></td>
                                    <td><input type="text" name="origine_mere" placeholder="Département/Commune"></td>
                                </tr>
                                <tr>
                                    <td><strong>Adresse</strong></td>
                                    <td><input type="text" name="adresse_pere"></td>
                                    <td><input type="text" name="adresse_mere"></td>
                                </tr>
                                <tr>
                                    <td><strong>Nombre d'enfants</strong></td>
                                    <td><input type="number" name="nb_enfants_pere" min="0" placeholder="Nombre d'enfants"></td>
                                    <td><input type="number" name="nb_enfants_mere" min="0" placeholder="Nombre d'enfants"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Informations complémentaires parents -->
                    <div style="margin-top: 20px;">
                        <div class="table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>Père</th>
                                        <th>Mère</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>NIF/CIN</strong></td>
                                        <td><input type="text" name="nif_pere" placeholder="NIF/CIN du père"></td>
                                        <td><input type="text" name="nif_mere" placeholder="NIF/CIN de la mère"></td>
                                    </tr>
                                    <tr>
                                        <td><strong>État civil</strong></td>
                                        <td>
                                            <select name="etat_civil_pere">
                                                <option value="">Sélectionner</option>
                                                <option value="celibataire">Célibataire</option>
                                                <option value="marie">Marié(e)</option>
                                                <option value="divorce">Divorcé(e)</option>
                                                <option value="veuf">Veuf/Veuve</option>
                                                <option value="union_libre">Union libre</option>
                                            </select>
                                        </td>
                                        <td>
                                            <select name="etat_civil_mere">
                                                <option value="">Sélectionner</option>
                                                <option value="celibataire">Célibataire</option>
                                                <option value="marie">Marié(e)</option>
                                                <option value="divorce">Divorcé(e)</option>
                                                <option value="veuf">Veuf/Veuve</option>
                                                <option value="union_libre">Union libre</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Niveau d'éducation</strong></td>
                                        <td>
                                            <select name="education_pere">
                                                <option value="">Sélectionner</option>
                                                <option value="aucun">Aucun</option>
                                                <option value="primaire">Primaire</option>
                                                <option value="secondaire">Secondaire</option>
                                                <option value="universitaire">Universitaire</option>
                                                <option value="professionnel">Professionnel</option>
                                            </select>
                                        </td>
                                        <td>
                                            <select name="education_mere">
                                                <option value="">Sélectionner</option>
                                                <option value="aucun">Aucun</option>
                                                <option value="primaire">Primaire</option>
                                                <option value="secondaire">Secondaire</option>
                                                <option value="universitaire">Universitaire</option>
                                                <option value="professionnel">Professionnel</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Occupation actuelle</strong></td>
                                        <td><input type="text" name="occupation_pere" placeholder="Occupation actuelle"></td>
                                        <td><input type="text" name="occupation_mere" placeholder="Occupation actuelle"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Questions sur le ménage -->
                        <div style="margin-top: 15px;">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Êtes-vous chef de ménage ?</label>
                                    <div class="radio-group">
                                        <div class="radio-item">
                                            <input type="radio" id="chef_menage_oui_pere" name="chef_menage_pere" value="oui">
                                            <label for="chef_menage_oui_pere">Oui (Père)</label>
                                        </div>
                                        <div class="radio-item">
                                            <input type="radio" id="chef_menage_non_pere" name="chef_menage_pere" value="non">
                                            <label for="chef_menage_non_pere">Non (Père)</label>
                                        </div>
                                        <div class="radio-item">
                                            <input type="radio" id="chef_menage_oui_mere" name="chef_menage_mere" value="oui">
                                            <label for="chef_menage_oui_mere">Oui (Mère)</label>
                                        </div>
                                        <div class="radio-item">
                                            <input type="radio" id="chef_menage_non_mere" name="chef_menage_mere" value="non">
                                            <label for="chef_menage_non_mere">Non (Mère)</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Sinon chez qui vivez-vous :</label>
                                <textarea name="chez_qui_vivez_vous" placeholder="Précisez chez qui vous vivez si vous n'êtes pas chef de ménage..."></textarea>
                            </div>

                            <div class="form-group">
                                <label>Combien de personnes vivent sous le même toit ?</label>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Mère :</label>
                                        <input type="number" name="nb_personnes_mere" min="0" placeholder="Nombre de personnes">
                                    </div>
                                    <div class="form-group">
                                        <label>Père :</label>
                                        <input type="number" name="nb_personnes_pere" min="0" placeholder="Nombre de personnes">
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Depuis combien de temps vous vivez ensemble ?</label>
                                <textarea name="duree_vie_ensemble" placeholder="Précisez la durée..."></textarea>
                            </div>

                            <div class="form-group">
                                <label>Si vous ne vivez pas ensemble, depuis combien de temps vous vivez dans cette maison ?</label>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Mère :</label>
                                        <textarea name="duree_maison_mere" placeholder="Durée dans cette maison..."></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label>Père :</label>
                                        <textarea name="duree_maison_pere" placeholder="Durée dans cette maison..."></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Informations sur les personnes à charges -->
                    <div style="margin-top: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h4>Information sur les personnes à charges / enfants biologiques / dépendants</h4>
                            <button type="button" class="btn btn-secondary" onclick="ajouterDependant()" style="padding: 5px 10px; font-size: 12px;">
                                + Ajouter dépendant
                            </button>
                        </div>
                        
                        <div id="dependants-container">
                            <div class="table-responsive">
                                <table id="table-dependants">
                                    <thead>
                                        <tr>
                                            <th>Prénom</th>
                                            <th>Âge</th>
                                            <th>Sexe</th>
                                            <th>Lien</th>
                                            <th>Scolarisation</th>
                                            <th>Niveau</th>
                                            <th>Lieu de résidence</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="dependants-tbody">
                                        <tr data-dependant="1">
                                            <td><input type="text" name="dependant_1_prenom" placeholder="Prénom"></td>
                                            <td><input type="number" name="dependant_1_age" min="0" placeholder="Âge"></td>
                                            <td>
                                                <select name="dependant_1_sexe">
                                                    <option value="">-</option>
                                                    <option value="M">M</option>
                                                    <option value="F">F</option>
                                                </select>
                                            </td>
                                            <td><input type="text" name="dependant_1_lien" placeholder="Lien"></td>
                                            <td><input type="text" name="dependant_1_scolarisation" placeholder="École"></td>
                                            <td><input type="text" name="dependant_1_niveau" placeholder="Classe"></td>
                                            <td><input type="text" name="dependant_1_residence" placeholder="Lieu"></td>
                                            <td>
                                                <button type="button" onclick="supprimerDependant(1)" class="signature-btn" style="background-color: #dc3545; color: white; display: none;">
                                                    ×
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Situation des grands-parents -->
                    <div style="margin-top: 20px;">
                        <h4>Quelle est la situation des grands-parents</h4>
                        <div class="form-row">
                            <div class="form-group" style="flex: 2;">
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="gd_mere_maternelle_vivante" name="gd_mere_maternelle_vivante" value="oui">
                                        <label for="gd_mere_maternelle_vivante">Grand-mère (maternelle) vivante</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="gd_mere_paternelle_vivante" name="gd_mere_paternelle_vivante" value="oui">
                                        <label for="gd_mere_paternelle_vivante">Grand-mère (paternelle) vivante</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="gd_pere_paternelle_vivant" name="gd_pere_paternelle_vivant" value="oui">
                                        <label for="gd_pere_paternelle_vivant">Grand-père (paternelle) vivant</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="gd_pere_maternelle_vivant" name="gd_pere_maternelle_vivant" value="oui">
                                        <label for="gd_pere_maternelle_vivant">Grand-père (maternelle) vivant</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Occupations :</label>
                                <textarea name="occupations_grands_parents" placeholder="Occupations des grands-parents vivants..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 3: Questions relatives à l'adoption -->
            <div class="section" data-step="3">
                <div class="section-title">Questions relatives à l'adoption</div>
                <div class="section-content">
                    <div class="form-group">
                        <label for="decision_adoption">Quand avez-vous pris la décision de placer votre enfant dans une crèche ?</label>
                        <textarea id="decision_adoption" name="decision_adoption" placeholder="Décrivez les circonstances..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="connaissance_creche">Connaissiez-vous cette crèche auparavant ?</label>
                        <textarea id="connaissance_creche" name="connaissance_creche" placeholder="Expliquez votre connaissance de cette institution..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="renseignement_creche">Sinon, qui vous a renseigné sur cette crèche ?</label>
                        <textarea id="renseignement_creche" name="renseignement_creche" placeholder="Indiquez qui vous a informé..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="frequence_visite">À quelle fréquence rendez-vous visite à vos enfants à la crèche / Chez cette personne ?</label>
                        <textarea id="frequence_visite" name="frequence_visite" placeholder="Décrivez la fréquence des visites..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="raison_adoption">Pourquoi aviez-vous décidé de donner votre enfant en adoption ?</label>
                        <textarea id="raison_adoption" name="raison_adoption" placeholder="Expliquez les raisons..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="apprentissage_adoption">Dites-nous tout ce que vous avez appris de l'adoption</label>
                        <textarea id="apprentissage_adoption" name="apprentissage_adoption" placeholder="Partagez vos connaissances sur l'adoption..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Section 4: Gestion des données -->
            <div class="section" data-step="4">
                <div class="section-title">Gestion des Données</div>
                <div class="section-content">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Statut du formulaire :</label>
                            <select id="formStatus" name="form_status">
                                <option value="brouillon">Brouillon</option>
                                <option value="en_cours">En cours de traitement</option>
                                <option value="complete">Complété</option>
                                <option value="approuve">Approuvé</option>
                                <option value="rejete">Rejeté</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Numéro de dossier :</label>
                            <input type="text" id="dossierNumber" name="dossier_number" readonly>
                        </div>
                        <div class="form-group">
                            <label>Date de création :</label>
                            <input type="datetime-local" id="creationDate" name="creation_date" readonly>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Notes internes :</label>
                            <textarea id="internalNotes" name="internal_notes" placeholder="Notes pour suivi interne..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Signatures Électroniques -->
            <div class="signature-section">
                <div class="section-title">Signatures Électroniques</div>
                <div class="section-content">
                    <div class="signature-container">
                        <!-- Signature du Parent/Tuteur -->
                        <div class="signature-box">
                            <h4 style="margin-bottom: 15px; color: #333;">Signature du Parent/Tuteur</h4>
                            <canvas id="parentSignature" class="signature-canvas" width="280" height="150"></canvas>
                            <div class="signature-controls">
                                <button type="button" class="signature-btn" onclick="clearSignature('parent')">Effacer</button>
                                <button type="button" class="signature-btn" onclick="saveSignature('parent')">Sauvegarder</button>
                            </div>
                            <div class="signature-info">
                                <div>Nom: <input type="text" id="parentName" name="parent_name" placeholder="Nom complet du parent" style="width: 200px; margin: 5px 0;"></div>
                                <div class="signature-date" id="parentDate">Date: Non signé</div>
                                <div class="signature-status pending" id="parentStatus">En attente</div>
                            </div>
                        </div>

                        <!-- Signature de l'Agent IBESR -->
                        <div class="signature-box">
                            <h4 style="margin-bottom: 15px; color: #333;">Signature de l'Agent IBESR</h4>
                            <canvas id="agentSignature" class="signature-canvas" width="280" height="150"></canvas>
                            <div class="signature-controls">
                                <button type="button" class="signature-btn" onclick="clearSignature('agent')">Effacer</button>
                                <button type="button" class="signature-btn" onclick="saveSignature('agent')">Sauvegarder</button>
                            </div>
                            <div class="signature-info">
                                <div>Agent: <input type="text" id="agentName" name="agent_name" placeholder="Nom de l'agent IBESR" style="width: 200px; margin: 5px 0;"></div>
                                <div>Titre: <input type="text" id="agentTitle" name="agent_title" placeholder="Membre Cellule Multidisciplinaire" style="width: 200px; margin: 5px 0;"></div>
                                <div class="signature-date" id="agentDate">Date: Non signé</div>
                                <div class="signature-status pending" id="agentStatus">En attente</div>
                            </div>
                        </div>
                    </div>

                    <!-- Informations légales -->
                    <div style="margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 5px; font-size: 12px;">
                        <p><strong>Note importante :</strong> En signant ce document électroniquement, vous certifiez que :</p>
                        <ul style="margin: 10px 0 0 20px;">
                            <li>Toutes les informations fournies sont exactes et complètes</li>
                            <li>Vous comprenez les implications légales de cette évaluation</li>
                            <li>Vous consentez au traitement des données personnelles conformément à la loi</li>
                            <li>Cette signature électronique a la même valeur légale qu'une signature manuscrite</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Navigation et soumission -->
            <div class="btn-container">
                <button type="button" class="btn btn-secondary" id="prevBtn" onclick="changeStep(-1)" style="display: none;">Précédent</button>
                <button type="button" class="btn" id="nextBtn" onclick="changeStep(1)">Suivant</button>
                <button type="submit" class="btn" id="submitBtn" style="display: none;">Soumettre le formulaire</button>
                <button type="button" class="btn btn-secondary" onclick="generatePDF()">Générer PDF</button>
                <button type="button" class="btn btn-secondary" onclick="exportData()">Exporter Données</button>
                <button type="button" class="btn btn-secondary" onclick="importData()">Importer Données</button>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImport(event)">
            </div>
        </form>

        <!-- Footer -->
        <div style="text-align: center; padding: 20px; border-top: 1px solid #ccc; margin-top: 20px;">
            <p>Fait à Port-au-Prince - IBESR, le <span id="currentDate"></span></p>
            <br>
            <p style="margin-top: 20px;">_________________________<br>Membre Cellule<br>Multidisciplinaire, IBESR</p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        let currentStep = 1;
        const totalSteps = 7; // Mise à jour du nombre total d'étapes
        let parentSignaturePad, agentSignaturePad;

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('fr-FR');
            
            // Générer numéro de dossier unique
            generateDossierNumber();
            
            // Définir date de création
            document.getElementById('creationDate').value = new Date().toISOString().slice(0, 16);
            
            showStep(currentStep);
            updateProgressBar();
            
            // Initialisation des canvas de signature
            const parentCanvas = document.getElementById('parentSignature');
            const agentCanvas = document.getElementById('agentSignature');
            
            if (parentCanvas && agentCanvas) {
                parentSignaturePad = new SignaturePad(parentCanvas);
                agentSignaturePad = new SignaturePad(agentCanvas);
                
                // Charger les signatures sauvegardées
                loadSignatures();
            }
            
            // Charger les données sauvegardées
            loadFormData();
        });

        function showStep(step) {
            const sections = document.querySelectorAll('.section');
            sections.forEach((section, index) => {
                if (parseInt(section.dataset.step) === step) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });

            // Gestion des boutons
            document.getElementById('prevBtn').style.display = step === 1 ? 'none' : 'inline-block';
            document.getElementById('nextBtn').style.display = step === totalSteps ? 'none' : 'inline-block';
            document.getElementById('submitBtn').style.display = step === totalSteps ? 'inline-block' : 'none';
        }

        function changeStep(direction) {
            if (direction === 1 && currentStep < totalSteps) {
                currentStep++;
            } else if (direction === -1 && currentStep > 1) {
                currentStep--;
            }
            
            showStep(currentStep);
            updateProgressBar();
        }

        function updateProgressBar() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function generateDossierNumber() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            
            const dossierNumber = `IBESR-${year}${month}${day}-${random}`;
            document.getElementById('dossierNumber').value = dossierNumber;
            
            return dossierNumber;
        }

        // Sauvegarde automatique dans localStorage
        function saveFormData() {
            const formData = new FormData(document.getElementById('evaluationForm'));
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            localStorage.setItem('formulaire_evaluation', JSON.stringify(data));
        }

        // Chargement des données sauvegardées
        function loadFormData() {
            const savedData = localStorage.getItem('formulaire_evaluation');
            if (savedData) {
                const data = JSON.parse(savedData);
                Object.keys(data).forEach(key => {
                    const element = document.querySelector(`[name="${key}"]`);
                    if (element) {
                        if (element.type === 'checkbox' || element.type === 'radio') {
                            element.checked = element.value === data[key];
                        } else {
                            element.value = data[key];
                        }
                    }
                });
            }
        }

        // ========== GESTION DES SIGNATURES ÉLECTRONIQUES ==========

        class SignaturePad {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.isDrawing = false;
                this.lastX = 0;
                this.lastY = 0;
                this.isEmpty = true;

                this.setupCanvas();
                this.bindEvents();
            }

            setupCanvas() {
                this.ctx.lineCap = 'round';
                this.ctx.lineJoin = 'round';
                this.ctx.strokeStyle = '#000000';
                this.ctx.lineWidth = 2;
                
                const rect = this.canvas.getBoundingClientRect();
                const dpr = window.devicePixelRatio || 1;
                
                this.canvas.width = rect.width * dpr;
                this.canvas.height = rect.height * dpr;
                
                this.ctx.scale(dpr, dpr);
                this.canvas.style.width = rect.width + 'px';
                this.canvas.style.height = rect.height + 'px';
            }

            bindEvents() {
                this.canvas.addEventListener('mousedown', (e) => this.startDrawing(e));
                this.canvas.addEventListener('mousemove', (e) => this.draw(e));
                this.canvas.addEventListener('mouseup', () => this.stopDrawing());
                this.canvas.addEventListener('mouseout', () => this.stopDrawing());

                this.canvas.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    const mouseEvent = new MouseEvent('mousedown', {
                        clientX: touch.clientX,
                        clientY: touch.clientY
                    });
                    this.canvas.dispatchEvent(mouseEvent);
                });

                this.canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    const mouseEvent = new MouseEvent('mousemove', {
                        clientX: touch.clientX,
                        clientY: touch.clientY
                    });
                    this.canvas.dispatchEvent(mouseEvent);
                });

                this.canvas.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    const mouseEvent = new MouseEvent('mouseup', {});
                    this.canvas.dispatchEvent(mouseEvent);
                });
            }

            getMousePos(e) {
                const rect = this.canvas.getBoundingClientRect();
                return {
                    x: e.clientX - rect.left,
                    y: e.clientY - rect.top
                };
            }

            startDrawing(e) {
                this.isDrawing = true;
                const pos = this.getMousePos(e);
                this.lastX = pos.x;
                this.lastY = pos.y;
                this.canvas.classList.add('active');
            }

            draw(e) {
                if (!this.isDrawing) return;

                const pos = this.getMousePos(e);
                
                this.ctx.beginPath();
                this.ctx.moveTo(this.lastX, this.lastY);
                this.ctx.lineTo(pos.x, pos.y);
                this.ctx.stroke();

                this.lastX = pos.x;
                this.lastY = pos.y;
                this.isEmpty = false;
            }

            stopDrawing() {
                if (this.isDrawing) {
                    this.isDrawing = false;
                    this.canvas.classList.remove('active');
                }
            }

            clear() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.isEmpty = true;
            }

            getDataURL() {
                return this.canvas.toDataURL('image/png');
            }

            fromDataURL(dataURL) {
                const img = new Image();
                img.onload = () => {
                    this.clear();
                    this.ctx.drawImage(img, 0, 0);
                    this.isEmpty = false;
                };
                img.src = dataURL;
            }
        }

        function clearSignature(type) {
            if (type === 'parent' && parentSignaturePad) {
                parentSignaturePad.clear();
                document.getElementById('parentDate').textContent = 'Date: Non signé';
                document.getElementById('parentStatus').textContent = 'En attente';
                document.getElementById('parentStatus').className = 'signature-status pending';
                
                localStorage.removeItem('signature_parent');
                localStorage.removeItem('signature_parent_date');
            } else if (type === 'agent' && agentSignaturePad) {
                agentSignaturePad.clear();
                document.getElementById('agentDate').textContent = 'Date: Non signé';
                document.getElementById('agentStatus').textContent = 'En attente';
                document.getElementById('agentStatus').className = 'signature-status pending';
                
                localStorage.removeItem('signature_agent');
                localStorage.removeItem('signature_agent_date');
            }
        }

        function saveSignature(type) {
            const now = new Date();
            const dateStr = now.toLocaleDateString('fr-FR') + ' à ' + now.toLocaleTimeString('fr-FR');
            
            if (type === 'parent' && parentSignaturePad && !parentSignaturePad.isEmpty) {
                const parentName = document.getElementById('parentName').value;
                if (!parentName.trim()) {
                    alert('Veuillez entrer le nom du parent avant de sauvegarder la signature.');
                    return;
                }
                
                const signatureData = parentSignaturePad.getDataURL();
                localStorage.setItem('signature_parent', signatureData);
                localStorage.setItem('signature_parent_date', dateStr);
                localStorage.setItem('signature_parent_name', parentName);
                
                document.getElementById('parentDate').textContent = 'Date: ' + dateStr;
                document.getElementById('parentStatus').textContent = 'Signé';
                document.getElementById('parentStatus').className = 'signature-status signed';
                
                alert('Signature du parent sauvegardée avec succès !');
                
            } else if (type === 'agent' && agentSignaturePad && !agentSignaturePad.isEmpty) {
                const agentName = document.getElementById('agentName').value;
                const agentTitle = document.getElementById('agentTitle').value;
                
                if (!agentName.trim()) {
                    alert('Veuillez entrer le nom de l\'agent avant de sauvegarder la signature.');
                    return;
                }
                
                const signatureData = agentSignaturePad.getDataURL();
                localStorage.setItem('signature_agent', signatureData);
                localStorage.setItem('signature_agent_date', dateStr);
                localStorage.setItem('signature_agent_name', agentName);
                localStorage.setItem('signature_agent_title', agentTitle);
                
                document.getElementById('agentDate').textContent = 'Date: ' + dateStr;
                document.getElementById('agentStatus').textContent = 'Signé';
                document.getElementById('agentStatus').className = 'signature-status signed';
                
                alert('Signature de l\'agent IBESR sauvegardée avec succès !');
                
            } else {
                alert('Veuillez d\'abord dessiner votre signature.');
            }
        }

        function loadSignatures() {
            // Charger signature parent
            const parentSig = localStorage.getItem('signature_parent');
            const parentDate = localStorage.getItem('signature_parent_date');
            const parentName = localStorage.getItem('signature_parent_name');
            
            if (parentSig && parentSignaturePad) {
                parentSignaturePad.fromDataURL(parentSig);
                if (parentDate) {
                    document.getElementById('parentDate').textContent = 'Date: ' + parentDate;
                    document.getElementById('parentStatus').textContent = 'Signé';
                    document.getElementById('parentStatus').className = 'signature-status signed';
                }
                if (parentName) {
                    document.getElementById('parentName').value = parentName;
                }
            }
            
            // Charger signature agent
            const agentSig = localStorage.getItem('signature_agent');
            const agentDate = localStorage.getItem('signature_agent_date');
            const agentName = localStorage.getItem('signature_agent_name');
            const agentTitle = localStorage.getItem('signature_agent_title');
            
            if (agentSig && agentSignaturePad) {
                agentSignaturePad.fromDataURL(agentSig);
                if (agentDate) {
                    document.getElementById('agentDate').textContent = 'Date: ' + agentDate;
                    document.getElementById('agentStatus').textContent = 'Signé';
                    document.getElementById('agentStatus').className = 'signature-status signed';
                }
                if (agentName) {
                    document.getElementById('agentName').value = agentName;
                }
                if (agentTitle) {
                    document.getElementById('agentTitle').value = agentTitle;
                }
            }
        }

        function validateSignatures() {
            const parentSigned = localStorage.getItem('signature_parent');
            const agentSigned = localStorage.getItem('signature_agent');
            
            if (!parentSigned) {
                alert('La signature du parent/tuteur est requise avant la soumission.');
                return false;
            }
            
            if (!agentSigned) {
                alert('La signature de l\'agent IBESR est requise avant la soumission.');
                return false;
            }
            
            return true;
        }

        // Génération PDF avec jsPDF
        function generatePDF() {
            if (!validateSignatures()) {
                return;
            }

            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                const pageWidth = pdf.internal.pageSize.width;
                const pageHeight = pdf.internal.pageSize.height;
                const margin = 20;
                let yPosition = margin;

                // En-tête
                pdf.setFontSize(16);
                pdf.setFont(undefined, 'bold');
                pdf.text('FORMULAIRE D\'EVALUATION SOCIALE ET ECONOMIQUE', pageWidth/2, yPosition, { align: 'center' });
                
                yPosition += 10;
                pdf.setFontSize(12);
                pdf.setFont(undefined, 'normal');
                pdf.text('Institut du Bien-Etre Social et de Recherches (IBESR)', pageWidth/2, yPosition, { align: 'center' });
                
                yPosition += 15;
                pdf.setFontSize(10);
                pdf.text(`Numero de dossier: ${document.getElementById('dossierNumber').value}`, margin, yPosition);
                pdf.text(`Date: ${new Date().toLocaleDateString('fr-FR')}`, pageWidth - margin - 40, yPosition);
                
                yPosition += 15;

                // Fonction pour ajouter une section
                function addSection(title, fields) {
                    if (yPosition > pageHeight - 50) {
                        pdf.addPage();
                        yPosition = margin;
                    }
                    
                    pdf.setFontSize(12);
                    pdf.setFont(undefined, 'bold');
                    pdf.text(title, margin, yPosition);
                    yPosition += 8;
                    
                    pdf.line(margin, yPosition, pageWidth - margin, yPosition);
                    yPosition += 8;
                    
                    pdf.setFontSize(10);
                    pdf.setFont(undefined, 'normal');
                    
                    fields.forEach(field => {
                        if (yPosition > pageHeight - 20) {
                            pdf.addPage();
                            yPosition = margin;
                        }
                        
                        const element = document.querySelector(`[name="${field.name}"]`) || document.getElementById(field.name);
                        const value = element ? (element.value || field.default || 'Non renseigne') : field.default || 'Non renseigne';
                        
                        const lines = pdf.splitTextToSize(`${field.label}: ${value}`, pageWidth - 2 * margin);
                        lines.forEach(line => {
                            pdf.text(line, margin, yPosition);
                            yPosition += 5;
                        });
                        yPosition += 2;
                    });
                    
                    yPosition += 5;
                }

                // Sections du formulaire
                addSection('1. IDENTIFICATION DES ENFANTS', [
                    { name: 'nom_enfant_1', label: 'Nom enfant 1' },
                    { name: 'prenom_enfant_1', label: 'Prenom enfant 1' },
                    { name: 'age_enfant_1', label: 'Age enfant 1' },
                    { name: 'sexe_enfant_1', label: 'Sexe enfant 1' },
                    { name: 'date_naissance_enfant_1', label: 'Date naissance enfant 1' },
                    { name: 'lieu_naissance_enfant_1', label: 'Lieu naissance enfant 1' },
                    { name: 'situation_sociale_1', label: 'Situation sociale enfant 1' }
                ]);

                // Ajouter dynamiquement les autres enfants au PDF
                for (let i = 2; i <= nombreEnfants; i++) {
                    const nomElement = document.querySelector(`[name="nom_enfant_${i}"]`);
                    if (nomElement && nomElement.value) {
                        addSection(`1.${i} ENFANT #${i}`, [
                            { name: `nom_enfant_${i}`, label: `Nom enfant ${i}` },
                            { name: `prenom_enfant_${i}`, label: `Prenom enfant ${i}` },
                            { name: `age_enfant_${i}`, label: `Age enfant ${i}` },
                            { name: `sexe_enfant_${i}`, label: `Sexe enfant ${i}` },
                            { name: `date_naissance_enfant_${i}`, label: `Date naissance enfant ${i}` },
                            { name: `lieu_naissance_enfant_${i}`, label: `Lieu naissance enfant ${i}` },
                            { name: `situation_sociale_${i}`, label: `Situation sociale enfant ${i}` }
                        ]);
                    }
                }

                addSection('2. IDENTIFICATION DES PARENTS BIOLOGIQUES', [
                    { name: 'nom_pere', label: 'Nom du pere' },
                    { name: 'prenom_pere', label: 'Prenom du pere' },
                    { name: 'nom_mere', label: 'Nom de la mere' },
                    { name: 'prenom_mere', label: 'Prenom de la mere' },
                    { name: 'age_pere', label: 'Age du pere' },
                    { name: 'age_mere', label: 'Age de la mere' },
                    { name: 'telephone_pere', label: 'Telephone du pere' },
                    { name: 'telephone_mere', label: 'Telephone de la mere' },
                    { name: 'profession_pere', label: 'Profession du pere' },
                    { name: 'profession_mere', label: 'Profession de la mere' },
                    { name: 'adresse_pere', label: 'Adresse du pere' },
                    { name: 'adresse_mere', label: 'Adresse de la mere' },
                    { name: 'nb_enfants_pere', label: 'Nombre d\'enfants du pere' },
                    { name: 'nb_enfants_mere', label: 'Nombre d\'enfants de la mere' },
                    { name: 'etat_civil_pere', label: 'Etat civil du pere' },
                    { name: 'etat_civil_mere', label: 'Etat civil de la mere' },
                    { name: 'education_pere', label: 'Niveau education du pere' },
                    { name: 'education_mere', label: 'Niveau education de la mere' }
                ]);

                addSection('3. INFORMATIONS SUR L\'HABITAT ET L\'ENVIRONNEMENT', [
                    { name: 'nombre_pieces', label: 'Nombre de pieces' },
                    { name: 'duree_maison', label: 'Duree dans cette maison' },
                    { name: 'nb_personnes_mere', label: 'Nombre de personnes (mere)' },
                    { name: 'nb_personnes_pere', label: 'Nombre de personnes (pere)' },
                    { name: 'duree_vie_ensemble', label: 'Duree de vie ensemble' },
                    { name: 'acces_services_mere', label: 'Acces aux services (mere)' },
                    { name: 'acces_services_pere', label: 'Acces aux services (pere)' }
                ]);

                addSection('4. LOISIRS ET RELATIONS FAMILIALES', [
                    { name: 'loisirs_mere_autres', label: 'Loisirs mere (autres)' },
                    { name: 'loisirs_pere_autres', label: 'Loisirs pere (autres)' },
                    { name: 'types_loisirs_mere_details', label: 'Types loisirs mere' },
                    { name: 'types_loisirs_pere_details', label: 'Types loisirs pere' },
                    { name: 'details_pere_mere_differents', label: 'Details pere/mere differents' },
                    { name: 'relation_fratrie_autre', label: 'Relation fratrie' },
                    { name: 'explications_temps_jouer', label: 'Explications temps de jeu' },
                    { name: 'pourquoi_enfants_decisions', label: 'Participation enfants decisions' }
                ]);

                addSection('5. ACTIVITE ECONOMIQUE ET CAPITAL', [
                    { name: 'type_activites_economiques', label: 'Types d\'activites economiques' },
                    { name: 'type_activite_actuelle', label: 'Activite economique actuelle' },
                    { name: 'qui_soutien_economiquement', label: 'Qui soutient economiquement' },
                    { name: 'principales_depenses', label: 'Principales sources de depenses' },
                    { name: 'explications_sans_manger', label: 'Explications securite alimentaire' },
                    { name: 'type_groupement_autres', label: 'Autres groupements sociaux' },
                    { name: 'capital_mere_terre', label: 'Capital mere - terre (gourdes)' },
                    { name: 'capital_pere_terre', label: 'Capital pere - terre (gourdes)' }
                ]);

                addSection('6. QUESTIONS RELATIVES A L\'ADOPTION', [
                    { name: 'decision_adoption', label: 'Decision de placement' },
                    { name: 'connaissance_creche', label: 'Connaissance de la creche' },
                    { name: 'renseignement_creche', label: 'Source d\'information' },
                    { name: 'depuis_quand_place', label: 'Depuis quand place' },
                    { name: 'frequence_visite', label: 'Frequence des visites' },
                    { name: 'raison_adoption', label: 'Raisons de l\'adoption' },
                    { name: 'apprentissage_adoption', label: 'Connaissances sur l\'adoption' },
                    { name: 'impressions_famille', label: 'Impressions de la famille' },
                    { name: 'decisions_apres_reflexion', label: 'Decisions apres reflexion' },
                    { name: 'pourquoi_pre_consentement_oui', label: 'Pourquoi signer pre-consentement' },
                    { name: 'pourquoi_pre_consentement_non', label: 'Pourquoi ne pas signer' },
                    { name: 'commentaires_remarques', label: 'Commentaires et remarques' },
                    { name: 'recommandations', label: 'Recommandations' }
                ]);

                addSection('7. INFORMATIONS ADMINISTRATIVES', [
                    { name: 'form_status', label: 'Statut du formulaire' },
                    { name: 'dossier_number', label: 'Numero de dossier' },
                    { name: 'creation_date', label: 'Date de creation' },
                    { name: 'internal_notes', label: 'Notes internes' }
                ]);

                // Signatures
                yPosition += 10;
                if (yPosition > pageHeight - 80) {
                    pdf.addPage();
                    yPosition = margin;
                }

                pdf.setFontSize(12);
                pdf.setFont(undefined, 'bold');
                pdf.text('8. SIGNATURES ELECTRONIQUES', margin, yPosition);
                yPosition += 15;

                const parentSig = localStorage.getItem('signature_parent');
                const parentDate = localStorage.getItem('signature_parent_date');
                const parentName = localStorage.getItem('signature_parent_name');
                
                if (parentSig && parentName) {
                    pdf.setFontSize(10);
                    pdf.setFont(undefined, 'normal');
                    pdf.text('Signature du Parent/Tuteur:', margin, yPosition);
                    yPosition += 8;
                    pdf.text(`Nom: ${parentName}`, margin, yPosition);
                    yPosition += 6;
                    pdf.text(`Date: ${parentDate}`, margin, yPosition);
                    yPosition += 10;
                    
                    try {
                        pdf.addImage(parentSig, 'PNG', margin, yPosition, 60, 20);
                        yPosition += 25;
                    } catch (e) {
                        pdf.text('[Signature electronique presente]', margin, yPosition);
                        yPosition += 8;
                    }
                }

                const agentSig = localStorage.getItem('signature_agent');
                const agentDate = localStorage.getItem('signature_agent_date');
                const agentName = localStorage.getItem('signature_agent_name');
                const agentTitle = localStorage.getItem('signature_agent_title');
                
                if (agentSig && agentName) {
                    pdf.text('Signature de l\'Agent IBESR:', margin, yPosition);
                    yPosition += 8;
                    pdf.text(`Nom: ${agentName}`, margin, yPosition);
                    yPosition += 6;
                    pdf.text(`Titre: ${agentTitle || 'Membre Cellule Multidisciplinaire'}`, margin, yPosition);
                    yPosition += 6;
                    pdf.text(`Date: ${agentDate}`, margin, yPosition);
                    yPosition += 10;
                    
                    try {
                        pdf.addImage(agentSig, 'PNG', margin, yPosition, 60, 20);
                    } catch (e) {
                        pdf.text('[Signature electronique presente]', margin, yPosition);
                    }
                }

                // Footer
                const totalPages = pdf.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    pdf.setPage(i);
                    pdf.setFontSize(8);
                    pdf.text(`Page ${i} / ${totalPages}`, pageWidth - margin - 20, pageHeight - 10);
                    pdf.text('IBESR - Formulaire d\'Evaluation Sociale et Economique', margin, pageHeight - 10);
                }

                const fileName = `Evaluation_${document.getElementById('dossierNumber').value}_${new Date().toISOString().slice(0, 10)}.pdf`;
                pdf.save(fileName);
                
                alert('PDF généré avec succès !');
                
            } catch (error) {
                console.error('Erreur génération PDF:', error);
                alert('Erreur lors de la génération du PDF. Utilisation de l\'impression standard.');
                
                // Fallback: impression standard
                const sections = document.querySelectorAll('.section');
                const signatureSection = document.querySelector('.signature-section');
                
                sections.forEach(section => {
                    section.style.display = 'block';
                });
                
                if (signatureSection) {
                    signatureSection.style.display = 'block';
                }
                
                setTimeout(() => {
                    window.print();
                    setTimeout(() => {
                        showStep(currentStep);
                    }, 1000);
                }, 500);
            }
        }

        function getFormDataAsObject() {
            const formData = new FormData(document.getElementById('evaluationForm'));
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            return data;
        }

        function exportData() {
            const data = {
                formData: getFormDataAsObject(),
                signatures: {
                    parent: localStorage.getItem('signature_parent'),
                    parentName: localStorage.getItem('signature_parent_name'),
                    parentDate: localStorage.getItem('signature_parent_date'),
                    agent: localStorage.getItem('signature_agent'),
                    agentName: localStorage.getItem('signature_agent_name'),
                    agentTitle: localStorage.getItem('signature_agent_title'),
                    agentDate: localStorage.getItem('signature_agent_date')
                },
                metadata: {
                    dossierNumber: document.getElementById('dossierNumber').value,
                    exportedAt: new Date().toISOString(),
                    version: '1.0'
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Formulaire_${document.getElementById('dossierNumber').value}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('Données exportées avec succès !');
        }

        function importData() {
            document.getElementById('importFile').click();
        }

        function handleImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (data.formData) {
                        Object.keys(data.formData).forEach(key => {
                            const element = document.querySelector(`[name="${key}"]`) || document.getElementById(key);
                            if (element) {
                                element.value = data.formData[key];
                            }
                        });
                    }
                    
                    if (data.signatures) {
                        if (data.signatures.parent) {
                            localStorage.setItem('signature_parent', data.signatures.parent);
                            localStorage.setItem('signature_parent_name', data.signatures.parentName || '');
                            localStorage.setItem('signature_parent_date', data.signatures.parentDate || '');
                        }
                        
                        if (data.signatures.agent) {
                            localStorage.setItem('signature_agent', data.signatures.agent);
                            localStorage.setItem('signature_agent_name', data.signatures.agentName || '');
                            localStorage.setItem('signature_agent_title', data.signatures.agentTitle || '');
                            localStorage.setItem('signature_agent_date', data.signatures.agentDate || '');
                        }
                    }
                    
                    if (parentSignaturePad && agentSignaturePad) {
                        loadSignatures();
                    }
                    
                    alert('Données importées avec succès !');
                    
                } catch (error) {
                    alert('Erreur lors de l\'importation des données. Vérifiez le format du fichier.');
                    console.error('Erreur d\'importation:', error);
                }
            };
            reader.readAsText(file);
        }

        // Soumission du formulaire
        document.getElementById('evaluationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const requiredFields = this.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.style.borderColor = 'red';
                    isValid = false;
                } else {
                    field.style.borderColor = '#ccc';
                }
            });
            
            if (!isValid) {
                alert('Veuillez remplir tous les champs obligatoires.');
                return;
            }
            
            if (!validateSignatures()) {
                return;
            }
            
            const formData = new FormData(this);
            
            const parentSig = localStorage.getItem('signature_parent');
            const agentSig = localStorage.getItem('signature_agent');
            const parentDate = localStorage.getItem('signature_parent_date');
            const agentDate = localStorage.getItem('signature_agent_date');
            
            if (parentSig) formData.append('signature_parent_data', parentSig);
            if (agentSig) formData.append('signature_agent_data', agentSig);
            if (parentDate) formData.append('signature_parent_date', parentDate);
            if (agentDate) formData.append('signature_agent_date', agentDate);
            
            saveFormData();
            
            document.getElementById('formStatus').value = 'complete';
            
            alert('Formulaire soumis avec succès ! Numéro de dossier: ' + document.getElementById('dossierNumber').value);
            
            if (confirm('Voulez-vous générer le PDF maintenant ?')) {
                generatePDF();
            }
        });

        // Sauvegarde automatique toutes les 30 secondes
        setInterval(saveFormData, 30000);

        // Sauvegarde avant fermeture de page
        window.addEventListener('beforeunload', saveFormData);

        // ========== GESTION DYNAMIQUE DES ENFANTS ==========
        
        let nombreEnfants = 1;
        let nombreDependants = 1;

        function ajouterEnfant() {
            nombreEnfants++;
            const container = document.getElementById('enfants-container');
            
            const nouvelEnfant = document.createElement('div');
            nouvelEnfant.className = 'enfant-form';
            nouvelEnfant.setAttribute('data-enfant', nombreEnfants);
            nouvelEnfant.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 10px; background-color: #f8f9fa; border-radius: 5px; border-top: 2px solid #007bff;">
                    <h4 style="margin: 0; color: #333;">Enfant #${nombreEnfants}</h4>
                    <button type="button" class="btn btn-secondary" onclick="supprimerEnfant(${nombreEnfants})" style="padding: 5px 10px; font-size: 12px; background-color: #dc3545;">
                        Supprimer
                    </button>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="nom_enfant_${nombreEnfants}">Nom :</label>
                        <input type="text" id="nom_enfant_${nombreEnfants}" name="nom_enfant_${nombreEnfants}">
                    </div>
                    <div class="form-group">
                        <label for="prenom_enfant_${nombreEnfants}">Prénom :</label>
                        <input type="text" id="prenom_enfant_${nombreEnfants}" name="prenom_enfant_${nombreEnfants}">
                    </div>
                    <div class="form-group">
                        <label for="age_enfant_${nombreEnfants}">Âge :</label>
                        <input type="number" id="age_enfant_${nombreEnfants}" name="age_enfant_${nombreEnfants}" min="0" max="18">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="sexe_enfant_${nombreEnfants}">Sexe :</label>
                        <select id="sexe_enfant_${nombreEnfants}" name="sexe_enfant_${nombreEnfants}">
                            <option value="">Sélectionner</option>
                            <option value="M">Masculin</option>
                            <option value="F">Féminin</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="date_naissance_enfant_${nombreEnfants}">Date de naissance :</label>
                        <input type="date" id="date_naissance_enfant_${nombreEnfants}" name="date_naissance_enfant_${nombreEnfants}">
                    </div>
                    <div class="form-group">
                        <label for="lieu_naissance_enfant_${nombreEnfants}">Lieu de naissance :</label>
                        <input type="text" id="lieu_naissance_enfant_${nombreEnfants}" name="lieu_naissance_enfant_${nombreEnfants}" placeholder="Lieu de naissance">
                    </div>
                </div>
                <div class="form-group">
                    <label for="situation_sociale_${nombreEnfants}">Situation sociale actuelle de cet enfant :</label>
                    <textarea id="situation_sociale_${nombreEnfants}" name="situation_sociale_${nombreEnfants}" placeholder="Décrivez la situation sociale actuelle de cet enfant..."></textarea>
                </div>
            `;
            
            container.appendChild(nouvelEnfant);
            
            // Afficher le bouton supprimer du premier enfant s'il y a plus d'un enfant
            if (nombreEnfants > 1) {
                const premierEnfantSupprimer = document.querySelector('[data-enfant="1"] button');
                if (premierEnfantSupprimer) {
                    premierEnfantSupprimer.style.display = 'inline-block';
                }
            }
            
            mettreAJourResumeEnfants();
        }

        function supprimerEnfant(numero) {
            if (nombreEnfants <= 1) {
                alert('Vous devez conserver au moins un enfant.');
                return;
            }
            
            const enfantASupprimer = document.querySelector(`[data-enfant="${numero}"]`);
            if (enfantASupprimer) {
                enfantASupprimer.remove();
                nombreEnfants--;
                
                // Masquer le bouton supprimer du premier enfant s'il n'y a qu'un seul enfant
                if (nombreEnfants === 1) {
                    const premierEnfantSupprimer = document.querySelector('[data-enfant="1"] button');
                    if (premierEnfantSupprimer) {
                        premierEnfantSupprimer.style.display = 'none';
                    }
                }
                
                mettreAJourResumeEnfants();
            }
        }

        function mettreAJourResumeEnfants() {
            const resume = document.getElementById('resume-enfants');
            const liste = document.getElementById('liste-enfants');
            
            if (nombreEnfants > 1) {
                resume.style.display = 'block';
                
                let contenuListe = '';
                const enfants = document.querySelectorAll('.enfant-form');
                
                enfants.forEach((enfant, index) => {
                    const numero = enfant.getAttribute('data-enfant');
                    const nom = enfant.querySelector(`[name="nom_enfant_${numero}"]`)?.value || 'Non renseigné';
                    const prenom = enfant.querySelector(`[name="prenom_enfant_${numero}"]`)?.value || 'Non renseigné';
                    const age = enfant.querySelector(`[name="age_enfant_${numero}"]`)?.value || 'Non renseigné';
                    
                    contenuListe += `<div style="padding: 5px 0; border-bottom: 1px solid #ccc;">
                        <strong>Enfant #${numero}:</strong> ${prenom} ${nom} (${age} ans)
                    </div>`;
                });
                
                liste.innerHTML = contenuListe;
            } else {
                resume.style.display = 'none';
            }
        }

        // ========== GESTION DYNAMIQUE DES DÉPENDANTS ==========

        function ajouterDependant() {
            nombreDependants++;
            const tbody = document.getElementById('dependants-tbody');
            
            const nouvelleLigne = document.createElement('tr');
            nouvelleLigne.setAttribute('data-dependant', nombreDependants);
            nouvelleLigne.innerHTML = `
                <td><input type="text" name="dependant_${nombreDependants}_prenom" placeholder="Prénom"></td>
                <td><input type="number" name="dependant_${nombreDependants}_age" min="0" placeholder="Âge"></td>
                <td>
                    <select name="dependant_${nombreDependants}_sexe">
                        <option value="">-</option>
                        <option value="M">M</option>
                        <option value="F">F</option>
                    </select>
                </td>
                <td><input type="text" name="dependant_${nombreDependants}_lien" placeholder="Lien"></td>
                <td><input type="text" name="dependant_${nombreDependants}_scolarisation" placeholder="École"></td>
                <td><input type="text" name="dependant_${nombreDependants}_niveau" placeholder="Classe"></td>
                <td><input type="text" name="dependant_${nombreDependants}_residence" placeholder="Lieu"></td>
                <td>
                    <button type="button" onclick="supprimerDependant(${nombreDependants})" class="signature-btn" style="background-color: #dc3545; color: white;">
                        ×
                    </button>
                </td>
            `;
            
            tbody.appendChild(nouvelleLigne);
            
            // Afficher le bouton supprimer du premier dépendant s'il y a plus d'un dépendant
            if (nombreDependants > 1) {
                const premierDependantSupprimer = document.querySelector('[data-dependant="1"] button');
                if (premierDependantSupprimer) {
                    premierDependantSupprimer.style.display = 'inline-block';
                }
            }
        }

        function supprimerDependant(numero) {
            if (nombreDependants <= 1) {
                alert('Vous devez conserver au moins un dépendant.');
                return;
            }
            
            const ligneASupprimer = document.querySelector(`[data-dependant="${numero}"]`);
            if (ligneASupprimer) {
                ligneASupprimer.remove();
                nombreDependants--;
                
                // Masquer le bouton supprimer du premier dépendant s'il n'y a qu'un seul dépendant
                if (nombreDependants === 1) {
                    const premierDependantSupprimer = document.querySelector('[data-dependant="1"] button');
                    if (premierDependantSupprimer) {
                        premierDependantSupprimer.style.display = 'none';
                    }
                }
            }
        }
    </script>
</body>
</html>